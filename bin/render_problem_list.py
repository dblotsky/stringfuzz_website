import sys
import yaml

WARNING = '''# WARNING:
#         this file is generated by {} from {{}}
'''.format(__file__)

def main():

    # read in problems in YAML
    source_file_path = sys.argv[1]
    problems         = yaml.load(sys.stdin.read())

    # go through each problem
    for problem in problems:

        # calculate end value
        end = problem['start'] + (problem['count'] * problem['increment'])

        # get its description
        old_description = problem['description']

        # use its properties and arguments as the render context
        context = dict()
        context.update(problem)
        context.update(problem['args'])
        context['end'] = end

        # render the description as a python format string
        new_description = old_description.format(**context)

        # save the new description
        problem['description'] = new_description

    # print out the problems in YAML
    print(WARNING.format(source_file_path))
    print(yaml.dump(problems))

if __name__ == '__main__':
    main()
